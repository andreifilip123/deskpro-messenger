webpackJsonp([1],{1794:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_objectWithoutProperties__=__webpack_require__(48),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_objectWithoutProperties___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_objectWithoutProperties__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_classCallCheck__=__webpack_require__(4),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_createClass__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_possibleConstructorReturn__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_possibleConstructorReturn___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_possibleConstructorReturn__),__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_inherits__=__webpack_require__(8),__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_inherits___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_inherits__),__WEBPACK_IMPORTED_MODULE_7_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_7_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_react__),__WEBPACK_IMPORTED_MODULE_8_prop_types__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_8_prop_types___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_prop_types__),__WEBPACK_IMPORTED_MODULE_9_redux__=__webpack_require__(269),__WEBPACK_IMPORTED_MODULE_10_react_intl__=__webpack_require__(95),__WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__=__webpack_require__(646),__WEBPACK_IMPORTED_MODULE_12__form_Button__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__),__webpack_require__(193)),__WEBPACK_IMPORTED_MODULE_13__utils_translateFieldLayout__=__webpack_require__(914),ChatEnterForm=function(_PureComponent){function ChatEnterForm(){return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_classCallCheck___default()(this,ChatEnterForm),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_possibleConstructorReturn___default()(this,(ChatEnterForm.__proto__||__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(ChatEnterForm)).apply(this,arguments))}return __WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_inherits___default()(ChatEnterForm,_PureComponent),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_createClass___default()(ChatEnterForm,[{key:"render",value:function render(){return __WEBPACK_IMPORTED_MODULE_7_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__.Form,null,__WEBPACK_IMPORTED_MODULE_7_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__.FieldLayout,this.props),__WEBPACK_IMPORTED_MODULE_7_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_12__form_Button__.a,{width:"full",size:"medium",color:"primary",type:"submit"},__WEBPACK_IMPORTED_MODULE_7_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_10_react_intl__.a,{id:"chat.enter_form.button",defaultMessage:"Start Conversation"})))}}]),ChatEnterForm}(__WEBPACK_IMPORTED_MODULE_7_react__.PureComponent);ChatEnterForm.propTypes={intl:__WEBPACK_IMPORTED_MODULE_8_prop_types___default.a.object.isRequired};var formEnhancer=Object(__WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__.withFormik)({enableReinitialize:!0,mapPropsToValues:function mapPropsToValues(_ref){var category=_ref.category,layout=_ref.layouts.getMatchingLayout({category:category});return layout?__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({category:category},layout.getDefaultValues()):{category:category}},handleSubmit:function handleSubmit(values,_ref2){var props=_ref2.props;_ref2.setSubmitting;props.onSubmit(values)}});__webpack_exports__.a=Object(__WEBPACK_IMPORTED_MODULE_9_redux__.d)(__WEBPACK_IMPORTED_MODULE_10_react_intl__.d,function mapProps(WrappedComponent){return function(_ref3){var formConfig=_ref3.formConfig,props=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_objectWithoutProperties___default()(_ref3,["formConfig"]);return __WEBPACK_IMPORTED_MODULE_7_react___default.a.createElement(WrappedComponent,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},props,{layouts:new __WEBPACK_IMPORTED_MODULE_11__deskpro_portal_components__.LayoutConfig(Object(__WEBPACK_IMPORTED_MODULE_13__utils_translateFieldLayout__.a)(formConfig,props.intl.formatMessage))}))}},formEnhancer)(ChatEnterForm),ChatEnterForm.__docgenInfo={description:"",displayName:"ChatEnterForm",props:{intl:{type:{name:"object"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/chat/ChatEnterForm.jsx"]={name:"ChatEnterForm",docgenInfo:ChatEnterForm.__docgenInfo,path:"src/components/chat/ChatEnterForm.jsx"})},911:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__=__webpack_require__(4),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__=__webpack_require__(8),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__),__WEBPACK_IMPORTED_MODULE_5_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_5_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_react__),__WEBPACK_IMPORTED_MODULE_6_prop_types__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_6_prop_types___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_prop_types__),__WEBPACK_IMPORTED_MODULE_7_react_redux__=__webpack_require__(645),__WEBPACK_IMPORTED_MODULE_8_redux__=__webpack_require__(269),__WEBPACK_IMPORTED_MODULE_9_react_intl__=__webpack_require__(95),__WEBPACK_IMPORTED_MODULE_10__components_chat_Chat__=__webpack_require__(912),__WEBPACK_IMPORTED_MODULE_11__components_chat_ChatEnterForm__=__webpack_require__(1794),__WEBPACK_IMPORTED_MODULE_12__components_core_Block__=__webpack_require__(909),__WEBPACK_IMPORTED_MODULE_13__modules_chat__=__webpack_require__(647),ChatScreen=function(_PureComponent){function ChatScreen(){var _ref,_temp,_this,_ret;__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this,ChatScreen);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default()(this,(_ref=ChatScreen.__proto__||__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default()(ChatScreen)).call.apply(_ref,[this].concat(args))),_this.state={viewMode:_this.props.preChatForm.length?"form":"chat",messages:[]},_this.handleSendMessage=function(message){var _this$props=_this.props,chatId=_this$props.chatId,category=_this$props.category;if(message){var messageModel="string"==typeof message?{message:message,origin:"user",type:"chat.message"}:message;chatId?_this.props.sendMessage(messageModel,category):(_this.setState(function(_ref2){return{messages:_ref2.messages.concat([messageModel])}}),_this.props.preChatForm.length||_this.state.messages.length||_this.props.createChat({category:category}))}},_this.submitPreChatForm=function(formValues){_this.props.createChat(formValues),_this.setState({viewMode:"chat"})},_ret=_temp,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default()(_this,_ret)}return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default()(ChatScreen,_PureComponent),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default()(ChatScreen,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _props=this.props,chatId=_props.chatId,sendMessage=_props.sendMessage,category=_props.category,isUnanswered=_props.isUnanswered;if(!prevProps.chatId&&chatId&&this.state.messages.forEach(function(message){return sendMessage(message,category)}),!prevProps.isUnanswered&&isUnanswered)switch(this.props.noAnswerBehavior){case"save_ticket":this.props.showSaveTicketForm({category:category,formConfig:this.props.ticketFormConfig});break;case"new_ticket":this.props.showCreateTicket({category:category})}}},{key:"render",value:function render(){var _props2=this.props,category=_props2.category,preChatForm=_props2.preChatForm,prompt=_props2.prompt,chatId=_props2.chatId,intl=_props2.intl,viewMode=this.state.viewMode,capCategory=category[0].toUpperCase()+category.substring(1);return __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_12__components_core_Block__.a,{title:intl.formatMessage({id:"chat.header."+category+"_title",defaultMessage:"{category} conversation"},{category:capCategory})},"form"===viewMode&&__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_11__components_chat_ChatEnterForm__.a,{category:category,onSubmit:this.submitPreChatForm,formConfig:preChatForm}),"chat"===viewMode&&__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_10__components_chat_Chat__.a,{messages:chatId?this.props.messages:this.state.messages,category:this.props.category,onSendMessage:this.handleSendMessage,typing:this.props.typing,chatId:chatId,prompt:prompt}))}}]),ChatScreen}(__WEBPACK_IMPORTED_MODULE_5_react__.PureComponent);ChatScreen.propTypes={chatId:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.string,messages:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.array,typing:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.object,preChatForm:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.array,prompt:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.string,isUnanswered:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.bool,noAnswerBehavior:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.oneOf(["save_ticket","new_ticket"])},ChatScreen.defaultProps={chatId:null,messages:[],typing:null,preChatForm:[],prompt:"",isUnanswered:!1,noAnswerBehavior:null};__webpack_exports__.default=Object(__WEBPACK_IMPORTED_MODULE_8_redux__.d)(Object(__WEBPACK_IMPORTED_MODULE_7_react_redux__.b)(function mapStateToProps(state,props){return{chatId:Object(__WEBPACK_IMPORTED_MODULE_13__modules_chat__.d)(state,props),messages:Object(__WEBPACK_IMPORTED_MODULE_13__modules_chat__.e)(state,props),typing:Object(__WEBPACK_IMPORTED_MODULE_13__modules_chat__.f)(state,props),isUnanswered:Object(__WEBPACK_IMPORTED_MODULE_13__modules_chat__.h)(state,props)}},{createChat:__WEBPACK_IMPORTED_MODULE_13__modules_chat__.b,sendMessage:__WEBPACK_IMPORTED_MODULE_13__modules_chat__.i,showSaveTicketForm:__WEBPACK_IMPORTED_MODULE_13__modules_chat__.k,showCreateTicket:__WEBPACK_IMPORTED_MODULE_13__modules_chat__.j}),__WEBPACK_IMPORTED_MODULE_9_react_intl__.d)(ChatScreen),ChatScreen.__docgenInfo={description:"",displayName:"ChatScreen",props:{chatId:{type:{name:"string"},required:!1,description:"",defaultValue:{value:"null",computed:!1}},messages:{type:{name:"array"},required:!1,description:"",defaultValue:{value:"[]",computed:!1}},typing:{type:{name:"object"},required:!1,description:"",defaultValue:{value:"null",computed:!1}},preChatForm:{type:{name:"array"},required:!1,description:"",defaultValue:{value:"[]",computed:!1}},prompt:{type:{name:"string"},required:!1,description:"",defaultValue:{value:"''",computed:!1}},isUnanswered:{type:{name:"bool"},required:!1,description:"",defaultValue:{value:"false",computed:!1}},noAnswerBehavior:{type:{name:"enum",value:[{value:"'save_ticket'",computed:!1},{value:"'new_ticket'",computed:!1}]},required:!1,description:"",defaultValue:{value:"null",computed:!1}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/ChatScreen.jsx"]={name:"ChatScreen",docgenInfo:ChatScreen.__docgenInfo,path:"src/screens/ChatScreen.jsx"})}});