webpackJsonp([0],{2210:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__=__webpack_require__(8),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__=__webpack_require__(9),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__),__WEBPACK_IMPORTED_MODULE_5_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_5_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_react__),__WEBPACK_IMPORTED_MODULE_6__utils_asset__=__webpack_require__(131),__WEBPACK_IMPORTED_MODULE_7_react_inlinesvg__=__webpack_require__(362),__WEBPACK_IMPORTED_MODULE_7_react_inlinesvg___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_react_inlinesvg__),__WEBPACK_IMPORTED_MODULE_8__core_ConfigContext__=__webpack_require__(152),Header=function(_PureComponent){function Header(){return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this,Header),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default()(this,(Header.__proto__||__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default()(Header)).apply(this,arguments))}return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default()(Header,_PureComponent),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default()(Header,[{key:"render",value:function render(){var greetingTitle=this.props.widget.greetingTitle;return __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement("div",{className:"dpmsg-ScreenHeader"},__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement("div",{className:"dpmsg-ScreenHeaderLogo"},"svg"==="img/dp-logo-white.svg".substr(-3)?__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_react_inlinesvg___default.a,{src:Object(__WEBPACK_IMPORTED_MODULE_6__utils_asset__.a)("img/dp-logo-white.svg"),alt:""}):__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement("img",{src:Object(__WEBPACK_IMPORTED_MODULE_6__utils_asset__.a)("img/dp-logo-white.svg"),alt:""})),__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement("span",{className:"dpmsg-ScreenHeaderTitle"},greetingTitle))}}]),Header}(__WEBPACK_IMPORTED_MODULE_5_react__.PureComponent);__webpack_exports__.a=Object(__WEBPACK_IMPORTED_MODULE_8__core_ConfigContext__.d)(Header),Header.__docgenInfo={description:"",displayName:"Header"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/Header.jsx"]={name:"Header",docgenInfo:Header.__docgenInfo,path:"src/components/ui/Header.jsx"})},2247:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__=__webpack_require__(8),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__=__webpack_require__(9),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits__),__WEBPACK_IMPORTED_MODULE_5_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_5_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_react__),__WEBPACK_IMPORTED_MODULE_6_prop_types__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_6_prop_types___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_prop_types__),__WEBPACK_IMPORTED_MODULE_7_react_router_dom__=__webpack_require__(132),__WEBPACK_IMPORTED_MODULE_8__core_Frame__=__webpack_require__(315),__WEBPACK_IMPORTED_MODULE_9__MessageForm__=__webpack_require__(1180),__WEBPACK_IMPORTED_MODULE_10__core_ConfigContext__=__webpack_require__(152),__WEBPACK_IMPORTED_MODULE_11__BotBubble__=__webpack_require__(1181),PromptMessage=function(_PureComponent){function PromptMessage(){var _ref,_temp,_this,_ret;__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this,PromptMessage);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default()(this,(_ref=PromptMessage.__proto__||__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default()(PromptMessage)).call.apply(_ref,[this].concat(args))),_this.handleEndChat=function(){_this.props.history.goBack()},_ret=_temp,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default()(_this,_ret)}return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_inherits___default()(PromptMessage,_PureComponent),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default()(PromptMessage,[{key:"render",value:function render(){var _props=this.props,prompt=_props.prompt,onSendMessage=_props.onSendMessage,frameContext=_props.frameContext;return __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_react__.Fragment,null,!!prompt&&__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_11__BotBubble__.a,{message:prompt}),__WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9__MessageForm__.a,{onSend:onSendMessage,frameContext:frameContext}))}}]),PromptMessage}(__WEBPACK_IMPORTED_MODULE_5_react__.PureComponent);PromptMessage.propTypes={prompt:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.string,onSendMessage:__WEBPACK_IMPORTED_MODULE_6_prop_types___default.a.func.isRequired},__webpack_exports__.a=Object(__WEBPACK_IMPORTED_MODULE_8__core_Frame__.b)(Object(__WEBPACK_IMPORTED_MODULE_7_react_router_dom__.g)(Object(__WEBPACK_IMPORTED_MODULE_10__core_ConfigContext__.d)(PromptMessage))),PromptMessage.__docgenInfo={description:"",displayName:"PromptMessage",props:{prompt:{type:{name:"string"},required:!1,description:""},onSendMessage:{type:{name:"func"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/chat/PromptMessage.jsx"]={name:"PromptMessage",docgenInfo:PromptMessage.__docgenInfo,path:"src/components/chat/PromptMessage.jsx"})},732:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_entries__=__webpack_require__(365),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_entries___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_entries__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__=__webpack_require__(233),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_slicedToArray__=__webpack_require__(81),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_classCallCheck__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_createClass__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_createClass__),__WEBPACK_IMPORTED_MODULE_7_babel_runtime_helpers_possibleConstructorReturn__=__webpack_require__(8),__WEBPACK_IMPORTED_MODULE_7_babel_runtime_helpers_possibleConstructorReturn___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_helpers_possibleConstructorReturn__),__WEBPACK_IMPORTED_MODULE_8_babel_runtime_helpers_inherits__=__webpack_require__(9),__WEBPACK_IMPORTED_MODULE_8_babel_runtime_helpers_inherits___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_babel_runtime_helpers_inherits__),__WEBPACK_IMPORTED_MODULE_9_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_9_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_react__),__WEBPACK_IMPORTED_MODULE_10_prop_types__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_10_prop_types___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_prop_types__),__WEBPACK_IMPORTED_MODULE_11_react_redux__=__webpack_require__(80),__WEBPACK_IMPORTED_MODULE_12_redux__=__webpack_require__(206),__WEBPACK_IMPORTED_MODULE_13_react_intl__=__webpack_require__(99),__WEBPACK_IMPORTED_MODULE_14__components_core_Block__=__webpack_require__(729),__WEBPACK_IMPORTED_MODULE_15__modules_chat__=__webpack_require__(154),__WEBPACK_IMPORTED_MODULE_16__modules_guest__=__webpack_require__(133),__WEBPACK_IMPORTED_MODULE_17__components_chat_PromptMessage__=__webpack_require__(2247),__WEBPACK_IMPORTED_MODULE_18__modules_info__=__webpack_require__(205),__WEBPACK_IMPORTED_MODULE_19__utils_common__=__webpack_require__(1178),__WEBPACK_IMPORTED_MODULE_20__components_ui_Header__=__webpack_require__(2210),TicketForm=Object(__WEBPACK_IMPORTED_MODULE_9_react__.lazy)(function(){return __webpack_require__.e(4).then(__webpack_require__.bind(null,2201))}),StartChatScreen=function(_PureComponent){function StartChatScreen(){var _ref,_temp,_this,_ret;__WEBPACK_IMPORTED_MODULE_5_babel_runtime_helpers_classCallCheck___default()(this,StartChatScreen);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=__WEBPACK_IMPORTED_MODULE_7_babel_runtime_helpers_possibleConstructorReturn___default()(this,(_ref=StartChatScreen.__proto__||__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StartChatScreen)).call.apply(_ref,[this].concat(args))),_this.state={viewMode:_this.props.preChatForm.length>0?"form":"prompt"},_this.promptMessage=_this.props.prompt?_this.props.intl.formatMessage({id:_this.props.prompt,defaultMessage:_this.props.prompt}):null,_this.createChat=function(values){var meta=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_this$props=_this.props,createChat=_this$props.createChat,screenName=_this$props.screenName,user=_this$props.user,postData={fields:{}},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_entries___default()(values));!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ref2=_step.value,_ref3=__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_slicedToArray___default()(_ref2,2),key=_ref3[0],value=_ref3[1];key.match(/^chat_field/)?postData.fields[key.split("_").splice(-1,1).join("")]=value:postData[key]=value}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}createChat(postData,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({fromScreen:screenName,name:user.name,email:user.email},meta))},_this.onSendMessage=function(message){var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chat.message";if(message&&"chat.message"===type){var _this$props2=_this.props,department=_this$props2.department,user=_this$props2.user,messageModel=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({origin:"user",type:"chat.message"},"string"==typeof message?{message:message}:message);_this.createChat({chat_department:department,name:user.name,email:user.email},{message:messageModel})}},_ret=_temp,__WEBPACK_IMPORTED_MODULE_7_babel_runtime_helpers_possibleConstructorReturn___default()(_this,_ret)}return __WEBPACK_IMPORTED_MODULE_8_babel_runtime_helpers_inherits___default()(StartChatScreen,_PureComponent),__WEBPACK_IMPORTED_MODULE_6_babel_runtime_helpers_createClass___default()(StartChatScreen,[{key:"render",value:function render(){var _props=this.props,department=_props.department,departments=_props.departments,preChatForm=_props.preChatForm,intl=_props.intl,user=_props.user,uploadTo=_props.uploadTo,formMessageEnabled=_props.formMessageEnabled,formMessage=_props.formMessage,viewMode=this.state.viewMode,dept=department?departments[department]:{},initialValues=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({},user),correctedForm=preChatForm,hiddenCount=0;correctedForm.length>0&&correctedForm[0].fields.forEach(function(f){"name"===f.field_id&&user.name&&(f.field_type="hidden",hiddenCount++),"email"===f.field_id&&user.email&&(f.field_type="hidden",hiddenCount++),"department"===f.field_type&&f.is_hidden&&hiddenCount++});var immutableLayout=Object(__WEBPACK_IMPORTED_MODULE_19__utils_common__.a)(correctedForm);return __WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9_react__.Fragment,null,__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_20__components_ui_Header__.a,null),__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_14__components_core_Block__.a,{title:intl.formatMessage({id:"chat.header.title",defaultMessage:"{department} conversation"},{department:dept.title})},"form"===viewMode&&correctedForm[0].fields.length!==hiddenCount&&[formMessageEnabled&&__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement("div",{key:"form_message",className:"dpmsg-StartChatScreen-FormMessage"},formMessage),__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9_react__.Suspense,{fallback:__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement("div",null,"Loading...")},__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(TicketForm,{key:"ticket_form",initialValues:initialValues,deskproLayout:immutableLayout,departmentPropName:"chat_department",departments:Object(__WEBPACK_IMPORTED_MODULE_19__utils_common__.a)(departments),department:department,fileUploadUrl:uploadTo,csrfToken:"not_used",onSubmit:this.createChat}))],("prompt"===viewMode||"form"===viewMode&&correctedForm[0].fields.length===hiddenCount)&&__WEBPACK_IMPORTED_MODULE_9_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_17__components_chat_PromptMessage__.a,{prompt:this.promptMessage,onSendMessage:this.onSendMessage})))}}]),StartChatScreen}(__WEBPACK_IMPORTED_MODULE_9_react__.PureComponent);StartChatScreen.propTypes={user:__WEBPACK_IMPORTED_MODULE_10_prop_types___default.a.object,preChatForm:__WEBPACK_IMPORTED_MODULE_10_prop_types___default.a.array,prompt:__WEBPACK_IMPORTED_MODULE_10_prop_types___default.a.string,departments:__WEBPACK_IMPORTED_MODULE_10_prop_types___default.a.object.isRequired},StartChatScreen.defaultProps={user:{},preChatForm:[],prompt:""};__webpack_exports__.default=Object(__WEBPACK_IMPORTED_MODULE_12_redux__.d)(Object(__WEBPACK_IMPORTED_MODULE_11_react_redux__.b)(function mapStateToProps(state,props){return{user:Object(__WEBPACK_IMPORTED_MODULE_16__modules_guest__.c)(state),departments:Object(__WEBPACK_IMPORTED_MODULE_18__modules_info__.e)(state,props)}},{createChat:__WEBPACK_IMPORTED_MODULE_15__modules_chat__.f,sendMessage:__WEBPACK_IMPORTED_MODULE_15__modules_chat__.q}),__WEBPACK_IMPORTED_MODULE_13_react_intl__.d)(StartChatScreen),StartChatScreen.__docgenInfo={description:"",displayName:"StartChatScreen",props:{user:{type:{name:"object"},required:!1,description:"",defaultValue:{value:"{}",computed:!1}},preChatForm:{type:{name:"array"},required:!1,description:"",defaultValue:{value:"[]",computed:!1}},prompt:{type:{name:"string"},required:!1,description:"",defaultValue:{value:"''",computed:!1}},departments:{type:{name:"object"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/StartChatScreen.jsx"]={name:"StartChatScreen",docgenInfo:StartChatScreen.__docgenInfo,path:"src/screens/StartChatScreen.jsx"})}});